# web 应用常见安全漏洞一览

## 1. SQL 注入

SQL 注入就是通过给 web 应用接口传入一些特殊字符，达到欺骗服务器执行恶意的 SQL 命令。

SQL 注入漏洞属于后端的范畴，但前端也可做体验上的优化。

### 原因

当使用外部不可信任的数据作为参数进行数据库的增、删、改、查时，如果未对外部数据进行转义，就会产生 SQL 注入漏洞。

比如：

```
name = "外部输入名称";

sql = "select * from users where name=" + name;
```

上面的 SQL 语句目的是通过用户输入的用户名查找用户信息，因为由于 SQL 语句是直接拼接的，没有进行转义，所以，当用户输入 `'' or '1'='1'`时，这个语句的功能就是搜索 `users` 全表的记录。

```
select * from users where name='' or '1'='1';
```

### 解决方案

具体的解决方案很多，但大部分都是基于一点：不信任任何外部输入。

所以，对任何外部输入都进行转义，然后再进行数据库的增、删、改、查。

此外，适当的权限控制、不曝露必要的安全信息和日志也有助于预防 SQL 注入漏洞。

参考 [Web 安全漏洞之 SQL 注入 - 防御方法](https://juejin.im/post/5bd5b820e51d456f72531fa8#heading-2) 了解具体的解决方案。

### 推荐参考

- [Web 安全漏洞之 SQL 注入](https://juejin.im/post/5bd5b820e51d456f72531fa8)
- [SQL 注入详解](https://segmentfault.com/a/1190000007520556)

## 2. XSS 攻击

XSS 攻击全称跨站脚本攻击（Cross-Site Scripting），简单的说就是攻击者通过在目标网站上注入恶意脚本并运行，获取用户的敏感信息如 Cookie、SessionID 等，影响网站与用户数据安全。

XSS 攻击更偏向前端的范畴，但后端在保存数据的时候也需要对数据进行安全过滤。

### 原因

当攻击者通过某种方式向浏览器页面注入了恶意代码，并且浏览器执行了这些代码。

比如：

在一个文章应用中（如微信文章），攻击者在文章编辑后台通过注入 `script` 标签及 `js` 代码，后端未加转义就保存到数据库，前端渲染文章详情的时候也未加转义，这就会让这段 `js` 代码执行，引起 XSS 攻击。

### 解决方案

一个基本的思路是渲染前端页面（不管是客户端渲染还是服务器端渲染）或者动态插入 html 片段时，任何数据都不可信任，都要先做 html 转义，然后再渲染。

参考 [前端安全系列（一）：如何防止XSS攻击？ - 攻击的预防](https://segmentfault.com/a/1190000016551188#articleHeader7) 了解具体的解决方案。

### 推荐参考

- [前端安全系列（一）：如何防止XSS攻击？](https://segmentfault.com/a/1190000016551188)
- [前端防御 XSS](https://juejin.im/entry/56da82a87664bf0052ebad41)
- [浅说 XSS 和 CSRF](https://juejin.im/entry/5b4b56fd5188251b1a7b2ac1)

## 3. CSRF 攻击

CSRF 攻击全称跨站请求伪造（Cross-site Request Forgery），简单的说就是攻击者盗用了你的身份，以你的名义发送恶意请求。

### 原因

一个典型的 CSRF 攻击有着如下的流程：

- 受害者登录 `a.com`，并保留了登录凭证（Cookie）
- 攻击者引诱受害者访问了 `b.com`
- `b.com` 向 `a.com` 发送了一个请求：`a.com/act=xx`（浏览器会默认携带 `a.com` 的 Cookie）
- `a.com` 接收到请求后，对请求进行验证，并确认是受害者的凭证，误以为是受害者自己发送的请求
- `a.com` 以受害者的名义执行了 `act=xx`
- 攻击完成，攻击者在受害者不知情的情况下，冒充受害者，让 `a.com` 执行了自己定义的操作

注：上面的过程摘自 [前端安全系列之二：如何防止CSRF攻击？](https://segmentfault.com/a/1190000016659945)

### 解决方案

防止 CSRF 攻击需要在服务器端入手，基本的思路是能正确识别是否是用户发起的请求。

参考 [前端安全系列之二：如何防止CSRF攻击？ - 防护策略](https://segmentfault.com/a/1190000016659945#articleHeader4) 了解具体的解决方案。

### 推荐参考

- [前端安全系列之二：如何防止CSRF攻击？](https://segmentfault.com/a/1190000016659945)
- [Web安全漏洞之CSRF](https://juejin.im/post/5ba1a800e51d450e8657f5dd)
- [浅说 XSS 和 CSRF](https://juejin.im/entry/5b4b56fd5188251b1a7b2ac1)

## 后续

更多博客，查看 [https://github.com/senntyou/blogs](https://github.com/senntyou/blogs)

作者：[深予之 (@senntyou)](https://github.com/senntyou)

版权声明：自由转载-非商用-非衍生-保持署名（[创意共享3.0许可证](https://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh)）
